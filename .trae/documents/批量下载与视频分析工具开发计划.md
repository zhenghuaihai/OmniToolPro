# 构建批量下载与视频分析工具计划

我们将开发一个基于 Python 的桌面应用程序，集成批量下载和视频内容分析功能。应用将采用模块化设计，以支持未来的工具扩展。

## 1. 技术栈选择
*   **编程语言**: Python 3.9+
*   **GUI 框架**: `PyQt6` (结合 `qfluentwidgets` 或自定义 QSS 实现现代化美观界面)
*   **网络/下载**: `aiohttp` (异步高并发下载), `requests`
*   **视频/音频处理**: `ffmpeg-python` (音频提取), `openai-whisper` (本地语音转文字)
*   **摘要生成**: `OpenAI API` (或其他 LLM 接口，用于文本摘要)
*   **打包工具**: `PyInstaller` (后续可用于打包为 exe/dmg)

## 2. 项目结构设计
```text
batch_tool/
├── main.py                 # 程序入口
├── config.py               # 配置管理
├── requirements.txt        # 依赖列表
├── assets/                 # 图标与样式资源
├── core/
│   ├── downloader.py       # 下载核心逻辑 (异步)
│   ├── audio_extractor.py  # 视频转音频逻辑
│   ├── transcriber.py      # 语音转文字逻辑 (Whisper)
│   └── summarizer.py       # 摘要生成逻辑 (LLM)
└── ui/
    ├── main_window.py      # 主窗口框架 (侧边栏/导航)
    ├── styles.qss          # 界面样式表
    ├── download_page.py    # 批量下载页面 UI
    └── video_page.py       # 视频分析页面 UI
```

## 3. 实施步骤

### 第一阶段：项目初始化与 UI 框架搭建
1.  创建项目目录结构。
2.  配置 `requirements.txt` 并安装依赖。
3.  搭建 `MainWindow`，实现左侧导航栏（"批量下载"、"视频工具"）与右侧内容区的切换架构，确保界面美观且易于扩展新页面。

### 第二阶段：开发批量下载功能
1.  **UI 实现**: 输入框（多行 URL）、目标文件夹选择器、文件名规则设置（如 `{原名}`, `{序号}_{原名}`）。
2.  **核心逻辑**:
    *   实现异步下载器，支持并发控制。
    *   自动识别文件类型和扩展名。
    *   实现进度条与状态显示（下载中、完成、失败）。
3.  **集成**: 将逻辑绑定到 UI，测试批量图片/文件下载。

### 第三阶段：开发视频分析功能 (逐字稿 + Summary)
1.  **UI 实现**: 视频文件拖拽/选择区、输出选项、API Key 配置（用于摘要）。
2.  **核心逻辑**:
    *   使用 `ffmpeg` 从视频提取音频。
    *   集成 `openai-whisper` 模型进行离线/在线语音转文字。
    *   调用 LLM API 对转录文本进行摘要总结。
3.  **输出**: 自动生成 `[视频名]_transcript.txt` 和 `[视频名]_summary.txt`。

### 第四阶段：测试与优化
1.  全局异常处理（网络错误、API 额度不足、文件权限等）。
2.  UI 细节打磨（加载动画、美观的按钮样式）。
3.  验证所有功能并准备交付。

## 关键特性
*   **可扩展性**: 采用 Page 模式，未来只需增加新的 Page 类并在导航栏注册即可添加新工具。
*   **美观性**: 使用现代化的 Flat 风格设计，支持深色/浅色模式（可选）。
*   **高性能**: 下载任务使用异步 I/O，不阻塞 UI 线程。
